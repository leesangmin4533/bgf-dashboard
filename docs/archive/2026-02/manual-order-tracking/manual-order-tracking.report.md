# Report: 수동 발주 추적 기능 (manual-order-tracking)

> **완료일**: 2026-02-05
> **PDCA 주기**: Plan → Design → Do → Check → Act → Report → Archive
> **Match Rate**: 100%

---

## 1. 프로젝트 개요

### 1.1 배경

기존 폐기 역추적 시스템은 **자동발주만 추적**하고 있어, 사용자가 수동으로 발주한 상품은 폐기 관리에서 누락되는 문제가 있었음.

```
[기존 Gap]
                    ┌─────────────────┐
자동발주 ──────────→│ order_tracking  │──→ 폐기 알림 ✅
                    └─────────────────┘
                              ↑
수동발주 ─────── X ───────────┘         폐기 알림 ❌ (누락)
```

### 1.2 목표

| 목표 | 달성 여부 |
|------|----------|
| 수동 발주 상품도 `order_tracking`에 등록 | ✅ 완료 |
| 자동/수동 발주 구분 가능 (스키마 확장) | ✅ 완료 |
| 동일한 폐기 알림 및 보고서 생성 보장 | ✅ 완료 |

---

## 2. 구현 요약

### 2.1 아키텍처

```
┌─────────────────────────────────────────────────────────────────────┐
│                        BGF 자동 발주 시스템                           │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  ┌──────────────┐      ┌─────────────────────┐                      │
│  │ BGF 사이트    │      │  receiving_history  │                      │
│  │ (입고 데이터) │─────→│  (입고 수집 완료)    │                      │
│  └──────────────┘      └──────────┬──────────┘                      │
│                                   │                                 │
│                                   ▼                                 │
│                    ┌──────────────────────────┐                     │
│                    │  ManualOrderDetector     │  ✅ 신규 모듈        │
│                    │  ─────────────────────── │                     │
│                    │  • 입고 vs 자동발주 대조  │                     │
│                    │  • 1차/2차 입고 모두 처리 │                     │
│                    │  • order_tracking 저장   │                     │
│                    └──────────────┬───────────┘                     │
│                                   │                                 │
│            ┌──────────────────────┼──────────────────────┐          │
│            ▼                      ▼                      ▼          │
│  ┌─────────────────┐   ┌─────────────────┐   ┌─────────────────┐   │
│  │ order_tracking  │   │inventory_batches│   │ ExpiryChecker   │   │
│  │ (source=manual) │   │ (비푸드 배치)    │   │ (폐기 알림)     │   │
│  └─────────────────┘   └─────────────────┘   └─────────────────┘   │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### 2.2 배송 스케줄 반영

프로젝트의 핵심인 **배송 스케줄**을 정확히 반영:

```
[발주일 D]
    10:00 발주 마감
    ↓
    20:00 1차 입고 (D일 저녁)
    ↓
[입고일 D+1]
    07:00 2차 입고 (D+1일 아침)
```

**스케줄링 적용**:
| 시간 | 목적 |
|------|------|
| 08:00 | 2차 입고(07:00) 완료 후 감지 |
| 21:00 | 1차 입고(20:00) 완료 후 감지 |

---

## 3. PDCA 이력

### 3.1 Phase Timeline

| Phase | 일시 | 산출물 | 결과 |
|-------|------|--------|------|
| Plan | 2026-02-05 | manual-order-tracking.plan.md | 요구사항 정의 완료 |
| Design | 2026-02-05 | manual-order-tracking.design.md | 상세 설계 완료 |
| Do | 2026-02-05 | 6개 파일 수정/생성 | 구현 완료 |
| Check | 2026-02-05 | manual-order-tracking.analysis.md | Match Rate 89% → 버그 발견 |
| Act | 2026-02-05 | 2건 버그 수정 | Match Rate 100% |
| Report | 2026-02-05 | 본 문서 | 완료 |
| Archive | 2026-02-05 | docs/archive/2026-02/ | 아카이브 완료 |

---

## 4. 결론

### 4.1 성과

- **문제 해결**: 수동 발주 상품의 폐기 추적 누락 문제 해결
- **Match Rate**: 100% 달성 (버그 1건 수정 포함)
- **하위 호환**: 기존 시스템에 영향 없음
- **확장성**: 향후 대시보드/알림 확장 가능

### 4.2 PDCA 효과

```
[Before]
수동발주 → 추적 불가 → 폐기 알림 누락 → 폐기 손실 증가

[After]
수동발주 → ManualOrderDetector → order_tracking → 폐기 알림 ✅
```

---

**보고서 작성 완료**: 2026-02-05
**아카이브 완료**: 2026-02-05
